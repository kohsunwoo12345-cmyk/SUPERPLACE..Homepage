<!DOCTYPE html>
<html>
<head>
    <title>썸네일 테스트</title>
</head>
<body>
    <h1>썸네일 업로드 테스트</h1>
    <input type="file" id="fileInput" accept="image/*">
    <div id="result"></div>
    
    <script>
        document.getElementById('fileInput').addEventListener('change', async function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<p>업로드 중...</p>';
            
            // 이미지 리사이징
            const img = new Image();
            img.onload = async function() {
                const canvas = document.createElement('canvas');
                let width = img.width;
                let height = img.height;
                
                const maxWidth = 1200;
                const maxHeight = 630;
                
                if (width > maxWidth || height > maxHeight) {
                    const ratio = Math.min(maxWidth / width, maxHeight / height);
                    width = Math.floor(width * ratio);
                    height = Math.floor(height * ratio);
                }
                
                canvas.width = width;
                canvas.height = height;
                
                const ctx = canvas.getContext('2d');
                ctx.drawImage(img, 0, 0, width, height);
                
                canvas.toBlob(async function(blob) {
                    const formData = new FormData();
                    formData.append('image', blob);
                    
                    try {
                        const apiKey = '0a23ef6b644bb80dfde639cbd5e4a5b7';
                        const response = await fetch(`https://api.imgbb.com/1/upload?key=${apiKey}`, {
                            method: 'POST',
                            body: formData
                        });
                        
                        const result = await response.json();
                        
                        if (result.success && result.data && result.data.url) {
                            resultDiv.innerHTML = `
                                <p>✅ 성공!</p>
                                <p>URL: ${result.data.url}</p>
                                <img src="${result.data.url}" style="max-width: 400px;">
                            `;
                        } else {
                            resultDiv.innerHTML = `<p>❌ 실패: ${JSON.stringify(result)}</p>`;
                        }
                    } catch (error) {
                        resultDiv.innerHTML = `<p>❌ 에러: ${error.message}</p>`;
                    }
                }, 'image/jpeg', 0.85);
            };
            
            img.src = URL.createObjectURL(file);
        });
    </script>
</body>
</html>
