<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI 학습 분석 리포트 로딩 중...</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
    <div class="min-h-screen flex items-center justify-center">
        <div class="text-center">
            <div class="animate-spin rounded-full h-16 w-16 border-b-4 border-purple-600 mx-auto mb-4"></div>
            <h2 class="text-2xl font-bold text-gray-900 mb-2">페이지 로딩 중...</h2>
            <p class="text-gray-600">잠시만 기다려주세요</p>
        </div>
    </div>
    <script>
        // 로그인 확인 후 동적 컨텐츠 로드
        async function init() {
            try {
                // 세션 확인
                const response = await fetch('/api/auth/check', {
                    credentials: 'include'
                });
                
                if (!response.ok) {
                    window.location.href = '/login?redirect=/tools/ai-learning-report';
                    return;
                }
                
                // 동적 콘텐츠 로드
                const contentResponse = await fetch('/api/tools/ai-learning-report-content');
                const html = await contentResponse.text();
                document.body.innerHTML = html;
                
                // 스크립트 실행
                const scripts = document.querySelectorAll('script');
                scripts.forEach(script => {
                    const newScript = document.createElement('script');
                    if (script.src) {
                        newScript.src = script.src;
                    } else {
                        newScript.textContent = script.textContent;
                    }
                    document.body.appendChild(newScript);
                });
            } catch (error) {
                console.error('Error:', error);
                document.body.innerHTML = `
                    <div class="min-h-screen flex items-center justify-center bg-gray-50">
                        <div class="text-center">
                            <h2 class="text-2xl font-bold text-red-600 mb-4">❌ 페이지 로드 실패</h2>
                            <p class="text-gray-600 mb-4">잠시 후 다시 시도해주세요</p>
                            <a href="/dashboard" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition inline-block">
                                대시보드로 돌아가기
                            </a>
                        </div>
                    </div>
                `;
            }
        }
        
        init();
    </script>
</body>
</html>
