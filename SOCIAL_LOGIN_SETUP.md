# ìš°ë¦¬ëŠ” ìŠˆí¼í”Œë ˆì´ìŠ¤ë‹¤ - ì†Œì…œ ë¡œê·¸ì¸ ì„¤ì • ê°€ì´ë“œ

## ğŸ‰ êµ¬ê¸€ & ì¹´ì¹´ì˜¤ ì†Œì…œ ë¡œê·¸ì¸ ê¸°ëŠ¥ ì¶”ê°€ ì™„ë£Œ!

ì†Œì…œ ë¡œê·¸ì¸ ê¸°ëŠ¥ì´ ì„±ê³µì ìœ¼ë¡œ êµ¬í˜„ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ì œ ì‚¬ìš©ìëŠ” êµ¬ê¸€ì´ë‚˜ ì¹´ì¹´ì˜¤ ê³„ì •ìœ¼ë¡œ ê°„í¸í•˜ê²Œ ë¡œê·¸ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## âœ¨ ì£¼ìš” ê¸°ëŠ¥

### 1. **êµ¬ê¸€ ë¡œê·¸ì¸ (Google OAuth 2.0)**
- Google Sign-In JavaScript ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©
- ë¯¸ê°€ì… ì‚¬ìš©ì ìë™ íšŒì›ê°€ì… í˜ì´ì§€ ë¦¬ë‹¤ì´ë ‰íŠ¸
- ì´ë©”ì¼, ì´ë¦„ ìë™ ì…ë ¥

### 2. **ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ (Kakao OAuth 2.0)**
- Kakao JavaScript SDK ì‚¬ìš©
- ë¯¸ê°€ì… ì‚¬ìš©ì ìë™ íšŒì›ê°€ì… í˜ì´ì§€ ë¦¬ë‹¤ì´ë ‰íŠ¸
- ì´ë©”ì¼, ë‹‰ë„¤ì„ ìë™ ì…ë ¥

### 3. **ê°„ì†Œí™”ëœ íšŒì›ê°€ì…**
- ì†Œì…œ ë¡œê·¸ì¸ ì‚¬ìš©ìëŠ” **í•™ì› ì´ë¦„**ê³¼ **í•™ì› ìœ„ì¹˜**ë§Œ ì…ë ¥
- ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ ë¶ˆí•„ìš”
- ì´ë©”ì¼ê³¼ ì´ë¦„ì€ ìë™ìœ¼ë¡œ ì…ë ¥ë¨

---

## ğŸš€ ë°°í¬ ë° ì„¤ì • ë°©ë²•

### 1ë‹¨ê³„: API í‚¤ ì„¤ì •

#### **êµ¬ê¸€ OAuth 2.0 ì„¤ì •**

1. **Google Cloud Console** ì ‘ì†: https://console.cloud.google.com/
2. í”„ë¡œì íŠ¸ ìƒì„± ë˜ëŠ” ì„ íƒ
3. **API ë° ì„œë¹„ìŠ¤ > ì‚¬ìš©ì ì¸ì¦ ì •ë³´** ì´ë™
4. **+ ì‚¬ìš©ì ì¸ì¦ ì •ë³´ ë§Œë“¤ê¸° > OAuth 2.0 í´ë¼ì´ì–¸íŠ¸ ID** ì„ íƒ
5. ì• í”Œë¦¬ì¼€ì´ì…˜ ìœ í˜•: **ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜**
6. **ìŠ¹ì¸ëœ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì›ë³¸** ì¶”ê°€:
   ```
   https://superplace-academy.pages.dev
   https://4ca9fea1.superplace.pages.dev
   http://localhost:3000
   ```
7. **ìŠ¹ì¸ëœ ë¦¬ë””ë ‰ì…˜ URI** ì¶”ê°€:
   ```
   https://superplace-academy.pages.dev/login
   https://4ca9fea1.superplace.pages.dev/login
   http://localhost:3000/login
   ```
8. **í´ë¼ì´ì–¸íŠ¸ ID** ë³µì‚¬ (ì˜ˆ: `123456789-abcdefg.apps.googleusercontent.com`)

#### **ì¹´ì¹´ì˜¤ OAuth 2.0 ì„¤ì •**

1. **Kakao Developers** ì ‘ì†: https://developers.kakao.com/
2. ë‚´ ì• í”Œë¦¬ì¼€ì´ì…˜ > ì• í”Œë¦¬ì¼€ì´ì…˜ ì¶”ê°€í•˜ê¸°
3. **ì•± í‚¤ > JavaScript í‚¤** ë³µì‚¬
4. **í”Œë«í¼ ì„¤ì • > Web í”Œë«í¼ ì¶”ê°€**
5. ì‚¬ì´íŠ¸ ë„ë©”ì¸ ì¶”ê°€:
   ```
   https://superplace-academy.pages.dev
   https://4ca9fea1.superplace.pages.dev
   http://localhost:3000
   ```
6. **ì œí’ˆ ì„¤ì • > ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ > Redirect URI** ë“±ë¡:
   ```
   https://superplace-academy.pages.dev/login
   https://4ca9fea1.superplace.pages.dev/login
   http://localhost:3000/login
   ```
7. **ë™ì˜í•­ëª© ì„¤ì •**: ì´ë©”ì¼, í”„ë¡œí•„ ì •ë³´ í•„ìˆ˜ ë™ì˜ë¡œ ì„¤ì •

---

### 2ë‹¨ê³„: í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

#### **ë¡œì»¬ ê°œë°œ í™˜ê²½**

`.dev.vars` íŒŒì¼ì„ ìˆ˜ì •í•˜ì—¬ API í‚¤ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤:

```bash
# .dev.vars
GOOGLE_CLIENT_ID=YOUR_GOOGLE_CLIENT_ID_HERE
KAKAO_JS_KEY=YOUR_KAKAO_JS_KEY_HERE
```

#### **í”„ë¡œë•ì…˜ í™˜ê²½ (Cloudflare Pages)**

Cloudflare Pagesì— í™˜ê²½ ë³€ìˆ˜ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤:

```bash
# Cloudflare ëŒ€ì‹œë³´ë“œì—ì„œ ì„¤ì •
npx wrangler pages secret put GOOGLE_CLIENT_ID --project-name superplace
# í”„ë¡¬í”„íŠ¸ì— YOUR_GOOGLE_CLIENT_ID_HERE ì…ë ¥

npx wrangler pages secret put KAKAO_JS_KEY --project-name superplace
# í”„ë¡¬í”„íŠ¸ì— YOUR_KAKAO_JS_KEY_HERE ì…ë ¥
```

ë˜ëŠ” Cloudflare Pages ëŒ€ì‹œë³´ë“œì—ì„œ ì§ì ‘ ì„¤ì •:
1. https://dash.cloudflare.com ì ‘ì†
2. **Pages > superplace > Settings > Environment variables**
3. **Add variable** í´ë¦­
4. `GOOGLE_CLIENT_ID` ì¶”ê°€ (Production, Preview ëª¨ë‘)
5. `KAKAO_JS_KEY` ì¶”ê°€ (Production, Preview ëª¨ë‘)

---

### 3ë‹¨ê³„: ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜

#### **ë¡œì»¬ ë°ì´í„°ë² ì´ìŠ¤**

```bash
cd /home/user/webapp
npx wrangler d1 migrations apply webapp-production --local
```

#### **í”„ë¡œë•ì…˜ ë°ì´í„°ë² ì´ìŠ¤**

```bash
npx wrangler d1 migrations apply webapp-production
```

---

### 4ë‹¨ê³„: ë¹Œë“œ ë° ë°°í¬

#### **ë¡œì»¬ í…ŒìŠ¤íŠ¸**

```bash
npm run build
pm2 start ecosystem.config.cjs
```

#### **í”„ë¡œë•ì…˜ ë°°í¬**

```bash
npm run build
npx wrangler pages deploy dist --project-name superplace
```

---

## ğŸ“ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

### users í…Œì´ë¸”ì— ì¶”ê°€ëœ ì»¬ëŸ¼

```sql
ALTER TABLE users ADD COLUMN google_id TEXT;
ALTER TABLE users ADD COLUMN kakao_id TEXT;
ALTER TABLE users ADD COLUMN profile_image TEXT;
ALTER TABLE users ADD COLUMN social_provider TEXT;
```

---

## ğŸ” ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

1. **API í‚¤ ë³´í˜¸**
   - `.dev.vars` íŒŒì¼ì€ `.gitignore`ì— í¬í•¨ë˜ì–´ ìˆìŒ
   - ì ˆëŒ€ë¡œ Gitì— ì»¤ë°‹í•˜ì§€ ë§ˆì„¸ìš”
   - í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” Cloudflare Secrets ì‚¬ìš©

2. **HTTPS ì‚¬ìš©**
   - ì†Œì…œ ë¡œê·¸ì¸ì€ HTTPS í™˜ê²½ì—ì„œë§Œ ì‘ë™
   - ë¡œì»¬ ê°œë°œì€ `http://localhost`ë§Œ í—ˆìš©

3. **ë„ë©”ì¸ ê²€ì¦**
   - êµ¬ê¸€ê³¼ ì¹´ì¹´ì˜¤ ì½˜ì†”ì— ì •í™•í•œ ë„ë©”ì¸ ë“±ë¡ í•„ìˆ˜

---

## ğŸ¯ ì‚¬ìš©ì í”Œë¡œìš°

### ì‹ ê·œ ì‚¬ìš©ì (ì†Œì…œ ë¡œê·¸ì¸)

1. `/login` í˜ì´ì§€ì—ì„œ **êµ¬ê¸€ë¡œ ê³„ì†í•˜ê¸°** ë˜ëŠ” **ì¹´ì¹´ì˜¤ë¡œ ê³„ì†í•˜ê¸°** í´ë¦­
2. ì†Œì…œ ë¡œê·¸ì¸ ì¸ì¦ ì™„ë£Œ
3. ë¯¸ê°€ì…ìì¼ ê²½ìš° ìë™ìœ¼ë¡œ `/register?from=google` ë˜ëŠ” `/register?from=kakao`ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
4. ì´ë©”ì¼ê³¼ ì´ë¦„ì€ ì´ë¯¸ ì…ë ¥ë˜ì–´ ìˆìŒ (ì½ê¸° ì „ìš©)
5. **í•™ì› ì´ë¦„**ê³¼ **í•™ì› ìœ„ì¹˜**ë§Œ ì…ë ¥
6. íšŒì›ê°€ì… ì™„ë£Œ â†’ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™
7. ë‹¤ì‹œ ì†Œì…œ ë¡œê·¸ì¸í•˜ë©´ ë°”ë¡œ ëŒ€ì‹œë³´ë“œë¡œ ì´ë™

### ê¸°ì¡´ ì‚¬ìš©ì (ì†Œì…œ ë¡œê·¸ì¸)

1. `/login` í˜ì´ì§€ì—ì„œ ì†Œì…œ ë¡œê·¸ì¸
2. ì´ë¯¸ ê°€ì…ëœ ê²½ìš° ë°”ë¡œ ëŒ€ì‹œë³´ë“œë¡œ ì´ë™

---

## ğŸ”§ API ì—”ë“œí¬ì¸íŠ¸

### `/api/auth/google` (POST)

êµ¬ê¸€ ë¡œê·¸ì¸ ì²˜ë¦¬

**Request Body:**
```json
{
  "idToken": "google_jwt_token",
  "email": "user@example.com",
  "name": "í™ê¸¸ë™",
  "picture": "https://..."
}
```

**Response (ê¸°ì¡´ ì‚¬ìš©ì):**
```json
{
  "success": true,
  "message": "êµ¬ê¸€ ë¡œê·¸ì¸ ì„±ê³µ",
  "user": {
    "id": 1,
    "email": "user@example.com",
    "name": "í™ê¸¸ë™",
    "role": "user",
    "points": 0,
    "profile_image": "https://..."
  }
}
```

**Response (ì‹ ê·œ ì‚¬ìš©ì):**
```json
{
  "success": false,
  "needsRegistration": true,
  "socialData": {
    "provider": "google",
    "email": "user@example.com",
    "name": "í™ê¸¸ë™",
    "picture": "https://...",
    "google_id": "google_jwt_token"
  },
  "message": "íšŒì›ê°€ì…ì´ í•„ìš”í•©ë‹ˆë‹¤."
}
```

### `/api/auth/kakao` (POST)

ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì²˜ë¦¬ (êµ¬ê¸€ ë¡œê·¸ì¸ê³¼ ë™ì¼í•œ êµ¬ì¡°)

---

## ğŸ“± í…ŒìŠ¤íŠ¸

### ë¡œì»¬ í…ŒìŠ¤íŠ¸

1. `.dev.vars` íŒŒì¼ì— API í‚¤ ì„¤ì •
2. `npm run build && pm2 start ecosystem.config.cjs`
3. http://localhost:3000/login ì ‘ì†
4. êµ¬ê¸€ ë˜ëŠ” ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸

### í”„ë¡œë•ì…˜ í…ŒìŠ¤íŠ¸

1. Cloudflare Pagesì— í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
2. ë°°í¬ ì™„ë£Œ í›„ https://superplace-academy.pages.dev/login ì ‘ì†
3. ì†Œì…œ ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸

---

## ğŸ“Š í˜„ì¬ ë°°í¬ ìƒíƒœ

- **GitHub**: âœ… í‘¸ì‹œ ì™„ë£Œ
  - Repository: https://github.com/kohsunwoo12345-cmyk/SUPERPLACE..Homepage
  - Commit: `Add Google and Kakao social login functionality`
  
- **Database**: âœ… ë¡œì»¬ ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ
  - Migration: `0019_add_social_login.sql`
  
- **Cloudflare Pages**: â³ ëŒ€ê¸° ì¤‘
  - API í‚¤ ì„¤ì • í•„ìš”
  - Cloudflare API í† í°ì„ Deploy íƒ­ì—ì„œ ì„¤ì •í•˜ì„¸ìš”

---

## âš ï¸ ë‹¤ìŒ ë‹¨ê³„

1. **Deploy íƒ­ì—ì„œ Cloudflare API í‚¤ ì„¤ì •**
2. **êµ¬ê¸€ OAuth 2.0 í´ë¼ì´ì–¸íŠ¸ ID ë°œê¸‰**
3. **ì¹´ì¹´ì˜¤ JavaScript í‚¤ ë°œê¸‰**
4. **Cloudflare Pagesì— í™˜ê²½ ë³€ìˆ˜ ì„¤ì •**
5. **í”„ë¡œë•ì…˜ ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰**
6. **í”„ë¡œë•ì…˜ ë°°í¬**

---

## ğŸ“ ë¬¸ì˜

ì„¤ì • ê³¼ì •ì—ì„œ ë¬¸ì œê°€ ë°œìƒí•˜ë©´ ì–¸ì œë“ ì§€ ë§ì”€í•´ì£¼ì„¸ìš”!

**ì›ì¥ë‹˜, ì´ì œ êµ¬ê¸€ê³¼ ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ê¸°ëŠ¥ì´ ì™„ì„±ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ‰**
