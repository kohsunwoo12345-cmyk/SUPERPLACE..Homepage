<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•™ë¶€ëª¨ ì†Œí†µ ì‹œìŠ¤í…œ - ì‘ë™í•˜ëŠ” ë²„ì „</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/variable/pretendardvariable.css');
        * {
            font-family: 'Pretendard Variable', Pretendard, -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
        }
        .gradient-purple {
            background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%);
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="pt-24 pb-12 px-6">
        <div class="max-w-5xl mx-auto">
            <div class="text-center mb-10">
                <h1 class="text-4xl font-bold text-gray-900 mb-4">ğŸ“± í•™ë¶€ëª¨ ì†Œí†µ ì‹œìŠ¤í…œ</h1>
                <p class="text-xl text-gray-600">í•™ìƒì„ ì„ íƒí•˜ì—¬ ë©”ì‹œì§€ë¥¼ ìƒì„±í•˜ì„¸ìš”</p>
            </div>

            <div class="grid lg:grid-cols-2 gap-8">
                <!-- ì…ë ¥ í¼ -->
                <div class="bg-white rounded-2xl shadow-lg p-8">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">í•™ìƒ ì •ë³´</h2>
                    
                    <div class="space-y-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-900 mb-2">í•™ìƒ ì„ íƒ *</label>
                            <select id="studentSelect" 
                                    class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 outline-none"
                                    onchange="showStudentInfo()">
                                <option value="">í•™ìƒì„ ì„ íƒí•˜ì„¸ìš”</option>
                            </select>
                        </div>

                        <div id="studentInfo" class="hidden bg-blue-50 border-l-4 border-blue-500 rounded-lg p-4">
                            <div class="text-sm font-medium text-blue-900 mb-2">ğŸ“Š í•™ìƒ ì •ë³´</div>
                            <div id="studentDetails" class="text-sm text-blue-800"></div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-900 mb-2">ì¶”ê°€ ë©”ëª¨</label>
                            <textarea id="memo" rows="3"
                                      class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 outline-none resize-none"
                                      placeholder="ì¶”ê°€ë¡œ ì „ë‹¬í•  ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                        </div>

                        <button onclick="generateMessage()" 
                                class="w-full gradient-purple text-white py-4 rounded-xl text-lg font-medium hover:shadow-xl transition">
                            âœ¨ ë©”ì‹œì§€ ìƒì„±í•˜ê¸°
                        </button>
                    </div>
                </div>

                <!-- ê²°ê³¼ -->
                <div class="bg-white rounded-2xl shadow-lg p-8">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">ìƒì„±ëœ ë©”ì‹œì§€</h2>
                    
                    <div id="result" class="hidden">
                        <div class="bg-purple-50 border-l-4 border-purple-600 rounded-lg p-6 mb-6">
                            <div id="generatedMessage" class="text-gray-800 leading-relaxed whitespace-pre-wrap"></div>
                        </div>
                        <button onclick="copyMessage()" 
                                class="w-full bg-purple-600 text-white py-3 rounded-xl font-medium hover:bg-purple-700 transition">
                            ğŸ“‹ ë³µì‚¬í•˜ê¸°
                        </button>
                    </div>

                    <div id="empty" class="text-center py-16">
                        <div class="w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <svg class="w-10 h-10 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"></path>
                            </svg>
                        </div>
                        <p class="text-gray-500">í•™ìƒì„ ì„ íƒí•˜ê³ <br>ë©”ì‹œì§€ë¥¼ ìƒì„±í•´ë³´ì„¸ìš”</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let students = [];
        let currentStudent = null;

        // í˜ì´ì§€ ë¡œë“œ ì‹œ
        window.addEventListener('DOMContentLoaded', function() {
            loadStudents();
        });

        // í•™ìƒ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°
        async function loadStudents() {
            try {
                const response = await fetch('https://superplace-academy.pages.dev/api/students?academyId=1');
                const data = await response.json();
                
                if (data.success) {
                    students = data.students;
                    const select = document.getElementById('studentSelect');
                    
                    data.students.forEach(function(student) {
                        const option = document.createElement('option');
                        option.value = student.id;
                        option.textContent = student.name + ' (' + student.grade + ', ' + (student.class_name || 'ë¯¸ë°°ì •') + ')';
                        select.appendChild(option);
                    });
                    
                    console.log('í•™ìƒ ëª©ë¡ ë¡œë“œ ì™„ë£Œ:', students.length + 'ëª…');
                }
            } catch (err) {
                console.error('Error:', err);
                alert('í•™ìƒ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + err.message);
            }
        }

        // í•™ìƒ ì •ë³´ í‘œì‹œ
        function showStudentInfo() {
            const select = document.getElementById('studentSelect');
            const studentId = select.value;
            
            if (!studentId) {
                document.getElementById('studentInfo').classList.add('hidden');
                return;
            }

            currentStudent = students.find(function(s) { return s.id == studentId; });
            
            if (currentStudent) {
                document.getElementById('studentDetails').innerHTML = 
                    '<div><strong>ì´ë¦„:</strong> ' + currentStudent.name + '</div>' +
                    '<div><strong>í•™ë…„:</strong> ' + currentStudent.grade + '</div>' +
                    '<div><strong>ê³¼ëª©:</strong> ' + currentStudent.subjects + '</div>' +
                    '<div><strong>í•™ë¶€ëª¨:</strong> ' + currentStudent.parent_name + ' (' + currentStudent.parent_phone + ')</div>';
                
                document.getElementById('studentInfo').classList.remove('hidden');
            }
        }

        // ë©”ì‹œì§€ ìƒì„±
        function generateMessage() {
            if (!currentStudent) {
                alert('í•™ìƒì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            const memo = document.getElementById('memo').value;
            
            let message = 'ì•ˆë…•í•˜ì„¸ìš”, ' + currentStudent.parent_name + ' í•™ë¶€ëª¨ë‹˜!\n\n';
            message += currentStudent.name + ' í•™ìƒ(' + currentStudent.grade + ')ì˜ í•™ìŠµ í˜„í™©ì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.\n\n';
            message += 'ğŸ“š ìˆ˜ê°• ê³¼ëª©: ' + currentStudent.subjects + '\n\n';
            
            if (memo) {
                message += 'ğŸ’¬ ì „ë‹¬ ì‚¬í•­:\n' + memo + '\n\n';
            }
            
            message += 'ê¶ê¸ˆí•˜ì‹  ì ì´ ìˆìœ¼ì‹œë©´ ì–¸ì œë“  ì—°ë½ ì£¼ì„¸ìš”.\n';
            message += 'ê°ì‚¬í•©ë‹ˆë‹¤.';

            document.getElementById('generatedMessage').textContent = message;
            document.getElementById('empty').classList.add('hidden');
            document.getElementById('result').classList.remove('hidden');
        }

        // ë³µì‚¬
        function copyMessage() {
            const message = document.getElementById('generatedMessage').textContent;
            navigator.clipboard.writeText(message).then(function() {
                alert('âœ… ë©”ì‹œì§€ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            });
        }
    </script>
</body>
</html>
